# LC-3 Assembler

This is a Python-based assembler for the LC-3 (Little Computer 3) architecture. It converts LC-3 assembly code into executable object files that can be run on the LC-3 virtual machine.

## Features

- Supports all standard LC-3 instructions
- Handles labels and symbols
- Supports .ORIG and .FILL pseudo-ops
- Generates binary object files compatible with the LC-3 VM
- Provides helpful error messages for common assembly errors

## Usage

### Basic Usage

```bash
python3 assembler.py input.asm [output.obj]
```

- `input.asm`: Path to the assembly source file
- `output.obj`: (Optional) Path for the output object file. If not specified, the output will be saved with the same name as the input file but with a .obj extension.

### Example

```bash
# Assemble hello.asm and create hello.obj
python3 assembler.py test/hello.asm

# Specify custom output file
python3 assembler.py test/hello.asm output/hello.obj
```

## Assembly Language Syntax

The assembler supports the standard LC-3 assembly syntax:

### Instructions

```
ADD  DR, SR1, SR2     ; Register mode
ADD  DR, SR1, imm5    ; Immediate mode
AND  DR, SR1, SR2     ; Bitwise AND (register)
AND  DR, SR1, imm5    ; Bitwise AND (immediate)
BRn  LABEL            ; Branch if negative
BRz  LABEL            ; Branch if zero
BRp  LABEL            ; Branch if positive
BRnz LABEL            ; Branch if negative or zero
BRnp LABEL            ; Branch if not positive
BRzp LABEL            ; Branch if zero or positive
BRnzp LABEL           ; Unconditional branch
JMP  BaseR            ; Jump to address in register
JSR  LABEL            ; Jump to subroutine
JSRR BaseR            ; Jump to subroutine (register)
LD   DR, LABEL        ; Load PC-relative
LDI  DR, LABEL        ; Load indirect
LDR  DR, BaseR, offset6 ; Load base+offset
LEA  DR, LABEL        ; Load effective address
NOT  DR, SR           ; Bitwise NOT
RET                   ; Return from subroutine
RTI                   ; Return from interrupt
ST   SR, LABEL        ; Store PC-relative
STI  SR, LABEL        ; Store indirect
STR  SR, BaseR, offset6 ; Store base+offset
TRAP trapvector8      ; System call
```

### Pseudo-ops

```
.ORIG x3000      ; Set program origin
.FILL x0000      ; Initialize memory location
.BLKW n          ; Block of n words
.STRINGZ "Hello" ; Null-terminated string
.END             ; End of program
```

### Comments

Comments start with a semicolon (`;`) and continue to the end of the line.

## Error Reporting

The assembler provides helpful error messages for common issues such as:
- Undefined labels
- Invalid opcodes
- Invalid operands
- Duplicate labels
- Memory overflow (beyond 65536 words)
- Invalid .ORIG values

## Integration with LC-3 VM

The object files generated by this assembler can be directly executed by the LC-3 virtual machine:

```bash
# Assemble the program
python3 assembler.py my_program.asm

# Run the program with the LC-3 VM
../bin/lc3vm my_program.obj
```

## License

This project is licensed under the MIT License - see the [LICENSE](../LICENSE) file for details.
